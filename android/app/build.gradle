plugins {
  id "com.android.application"
  id "org.jetbrains.kotlin.android"
  id "dev.flutter.flutter-gradle-plugin"
}

/* Load signing props written by CI to android/key.properties */
def keystoreProperties = new Properties()
def keystorePropertiesFile = rootProject.file("key.properties")
if (keystorePropertiesFile.exists()) {
  keystoreProperties.load(new FileInputStream(keystorePropertiesFile))
}

android {
  namespace "dev.ahmer.autocarepro"
  compileSdk 35

  defaultConfig {
    applicationId "dev.ahmer.autocarepro"
    minSdk 23
    targetSdk 35
    versionCode 1
    versionName "1.0"
    multiDexEnabled true
  }

  /* Release signing â€“ uses properties provided by CI */
  signingConfigs {
    release {
      if (keystoreProperties['storeFile']) {
        storeFile file(keystoreProperties['storeFile'])
        storePassword keystoreProperties['storePassword']
        keyAlias keystoreProperties['keyAlias']
        keyPassword keystoreProperties['keyPassword']
        enableV1Signing true
        enableV2Signing true
      }
    }
  }

  buildTypes {
    release {
      minifyEnabled false
      shrinkResources false
      signingConfig signingConfigs.release
    }
    debug { }
  }

  // (Optional) helps some CI envs
  packagingOptions {
    jniLibs { useLegacyPackaging = true }
  }

  compileOptions {
    sourceCompatibility JavaVersion.VERSION_17
    targetCompatibility JavaVersion.VERSION_17
    coreLibraryDesugaringEnabled true
  }
  kotlinOptions {
    jvmTarget = "17"
    freeCompilerArgs += ["-Xjvm-default=all"]
  }
}

dependencies {
  coreLibraryDesugaring "com.android.tools:desugar_jdk_libs:2.1.4"
  implementation "androidx.core:core-ktx:1.13.1"
  implementation "androidx.multidex:multidex:2.0.1"
}